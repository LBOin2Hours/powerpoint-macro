Sub convert_ppt_to_txt()
    
    Call ungroup_shapes
    
    Dim next_string_to_append As String
    
    Dim all_text_output As String
    Dim number_only_output As String
    all_text_output = "C:\Users\Aaron\Desktop\Examine_2_All_Text.txt"
    number_only_output = "C:\Users\Aaron\Desktop\Examine_1_Numbers.txt"
    
    ' cannot set p as active presentation otherwise it's going to impact other opened ppt files
    Dim p As Presentation: Set p = ActivePresentation
    Dim s As Slide
    Dim sh As Shape
    For Each s In p.Slides
        For Each sh In s.Shapes
            If sh.HasTextFrame Then
                If sh.TextFrame.HasText Then
                    next_string_to_append = sh.TextFrame.TextRange.Text
                    Call WriteStringToFile(all_text_output, next_string_to_append)
                    
                    If containsNumber(next_string_to_append) Then
                        Call WriteStringToFile(number_only_output, next_string_to_append)
                    End If

                End If
            End If
        Next
    Next
    
    Call SendFileToNotePad(all_text_output)
    Call SendFileToNotePad(number_only_output)
    
End Sub


Function containsNumber(inputString As String) As Boolean

    Dim counter As Integer
    Dim hasNumber As Boolean
    
    containsNumber = False
    
    For counter = 1 To Len(inputString)
        If IsNumeric(Mid(inputString, counter, 1)) Then
            containsNumber = True
            Exit For
        End If
    Next


End Function



Function IsAlpha2(s) As Boolean
    IsAlpha2 = Len(s) And Not s Like "*[!a-zA-Z. ]*"
End Function


Sub WriteStringToFile(pFileName As String, pString As String)

    Dim intFileNum As Integer
    
    intFileNum = FreeFile
                ' change Output to Append if you want to add to an existing file
                ' rather than creating a new file each time
    Open pFileName For Append As intFileNum
    Print #intFileNum, pString
    Close intFileNum

End Sub

Sub SendFileToNotePad(pFileName As String)
    Dim lngReturn As Long

    lngReturn = Shell("NOTEPAD.EXE " & pFileName, vbNormalFocus)

End Sub

Sub ungroup_shapes()
    
    Dim p As Presentation: Set p = ActivePresentation
    Dim s As Slide
    Dim sh As Shape
    
    For Each s In p.Slides
        For x = 1 To 10
            For Each sh In s.Shapes
                If sh.Type = msoGroup Then sh.Ungroup
            Next
        Next x
    Next
    
    
End Sub


